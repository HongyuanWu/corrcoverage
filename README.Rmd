---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

[![Coverage status](https://codecov.io/gh/annahutch/corrcoverage/branch/master/graph/badge.svg)](https://codecov.io/github/annahutch/corrcoverage?branch=master)

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# corrcoverage

Webpage: https://annahutch.github.io/corrcoverage/

The `corrcoverage` R package uses a computationally efficient algorithm to find accurate coverage estimates of the causal variant in credible sets obtained using the Bayesian approach for fine-mapping ([Maller et al., 2012](https://www.ncbi.nlm.nih.gov/pubmed/23104008), [Wakefield, 2009](https://onlinelibrary.wiley.com/doi/abs/10.1002/gepi.20359).).

The package only requires GWAS summary statistics and can be used to:

* Perform Bayesian fine-mapping
* Estimate the true genetic effect at the causal variant (see `est_mu` function).
* Obtain an accurate coverage estimate of the causal variant in a credible set, the 'corrected coverage estimate' (see `corrcov` function and 'Corrected Coverage' vignette).
* Find a new 'corrected' credible set with the desired coverage (see `corrected_cs` function and 'New Credible Set' vignette).

Please see the [flowchart avaliable here](https://annahutch.github.io/PhD/package_flowchart.html) to decide which function is best to solve your problem.

<!DOCTYPE html>
<html>
<head>
<title>package_flowchart</title>
<meta charset="utf-8"/>
</head>
<body><div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;&lt;mxfile modified=\&quot;2019-05-08T15:00:12.861Z\&quot; host=\&quot;www.draw.io\&quot; agent=\&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36\&quot; etag=\&quot;pGKqXuTAFSP7j4F05nyi\&quot; version=\&quot;10.6.7\&quot; type=\&quot;device\&quot;&gt;&lt;diagram name=\&quot;Page-1\&quot; id=\&quot;8ce9d11a-91a2-4d17-14d8-a56ed91bf033\&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;&quot;}"></div>
<script type="text/javascript" src="https://www.draw.io/js/viewer.min.js"></script>
</body>
</html>


----

## Installation

You can install the released version of `corrcoverage` from [github](https://github.com/) with:

``` {r eval=FALSE}
install.packages("devtools") # if not already installed
devtools::install_github("annahutch/corrcoverage")
```

----

## Examples

For examples, please see the vignettes on the webpage [here](http://annahutch.github.io/corrcoverage/articles/my-vignette.html). 

The 'Corrected Coverage' vignette [here](https://annahutch.github.io/corrcoverage/articles/my-vignette.html) should be read first. This shows readers how to use the `corrcoverage` package to get an accurate coverage estimate of the causal variant in a credible set.

The 'New Credible Set' vignette [here](https://annahutch.github.io/corrcoverage/articles/New-Credible-Set.html) follows on from the 'Corrected Coverage' vignette and shows readers how the `corrcoverage` package can be used to obtain a new credible set with the desired coverage of the causal variant.

The 'Useful Info' vignette [here](https://annahutch.github.io/corrcoverage/articles/Useful-Info.html) provides supplementary information about the usage of the package, including information about other useful functions. 

----

In brief, the correction method involves simulating many credible sets from 'the same system as the original' and finding what proportion of these contain the true causal variant, whereby each variant is considered causal in turn and the predictions are normalised by that variant's posterior probability of causality. 

----

## Abstract

The primary goal of Genome Wide Association Studies (GWAS) is to better understand the biology of disease. GWAS have been successful in identifying thousands of associations with common and complex diseases, but these associations refer to physical genomic regions rather than specific causal variants responsible for the disease. Consequently, known GWAS association signals are used in follow-up studies, which continue to untangle the relationship between genetic variation and disease. Accurately localising the specific “causal variants” driving the association signals identified by GWAS is difficult due to correlations between SNPs. Standard practice in fine-mapping experiments is therefore to report a credible set of variants which is believed to contain the causal variant with some “coverage probability”.

We evaluated coverage probabilities of credible sets obtained using the dominant method in the field and found that the claimed coverage probabilities were systematically biased. In low power studies the true coverage was below that claimed, suggesting that researchers should add more variants to the credible set in order to achieve the required coverage. In high power studies, the true coverage was higher than that claimed, potentially allowing for higher resolution through the removal of variants from the set, whilst still attaining the required coverage. The algorithm to create credible sets contains an ordering step, which aims to make the set as small as possible, but which is not accounted for when estimating coverage probabilities. We showed that it is this ordering step that induces coverage bias and have developed a method to estimate this bias using rapid simulations based on the observed SNP correlation structure. We provide R software for our method which provides the user with an accurate coverage estimate of the causal variant in the credible set. Obtaining accurate coverage estimates will allow researchers to adjust their credible set to achieve the true desired coverage - for example narrowing down a 95% credible set of 10 variants to just 5 variants. 

While technical, our result - that standard coverage estimates of the causal variant in GWAS are inaccurate and can be improved - impacts standard practice in genetic association studies. Improvement in the resolution of the fine-mapping experiment will enable more efficient expenditure of resources in the follow-up process of annotating the variants in the credible set to determine the implicated genes and pathways, helping to untangle the complex relationship between genetic variants and disease.

-----
